<!DOCTYPE html>
<html>
<head>
    <title>Checkout - Camiseta X</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://sdk.mercadopago.com/js/v2"></script>
    <style>
        /* Estilos CSS básicos para centralizar */
        body { font-family: sans-serif; background-color: #f4f4f4; padding-top: 20px; }
        .checkout-container { max-width: 500px; margin: 0 auto; padding: 20px; background-color: #ffffff; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; }
        .item-info { text-align: center; margin-bottom: 20px; font-size: 1.1em; }
    </style>
</head>
<body>

    <div class="checkout-container">
        <h1>Finalize sua Compra</h1>
        <div class="item-info">
            <p><strong>Produto:</strong> Camiseta X</p>
            <p><strong>Valor:</strong> R$ 99,00 (Exemplo)</p>
        </div>
        
        <div id="payment-brick-container"></div>
    </div>

    <script>
        // 1. Inicialize o SDK com sua Public Key
        const mp = new MercadoPago(APP_USR-b1451772-502e-4a0e-8be0-a7b83549a447, {
            locale: 'pt-BR'
        });

        // 2. Gere o Payment Brick
        const bricksBuilder = mp.bricks();

        const renderPaymentBrick = async (bricksBuilder) => {
            const settings = {
                initialization: {
                    amount: 99.00, // Valor total (inclua aqui o frete se for fixo)
                    preferenceId: null, // Deixe null para checkout dinâmico
                    // ATENÇÃO: Se for vender a Camiseta X, use o id da preferência que será criada na etapa D.
                },
                customization: {
                    visual: {
                        hidePaymentButton: true, // Esconder o botão padrão para customizar a UI
                    },
                    // *** CONFIGURAÇÃO CRUCIAL PARA O ENDEREÇO ***
                    checkout: {
                        theme: 'default',
                        // Ativar coleta de dados do comprador e endereço de entrega
                        allowAddressInformation: true, 
                        allowPayerInformation: true,
                        // Configuração do frete (o valor aqui será somado ao valor inicial)
                        items: [
                             {
                                id: "CAMISA-X-001",
                                title: "Camiseta X",
                                quantity: 1,
                                unit_price: 99.00,
                                // Adicione informações de frete aqui se for fixo
                             }
                        ],
                    }
                },
                callbacks: {
                    onReady: () => {
                        // Callback quando o Brick estiver pronto
                        console.log('Payment Brick pronto!');
                    },
                    onSubmit: async (cardFormData) => {
                        // Este é o passo mais complexo: enviar dados para seu Access Token no backend
                        // Como você não tem backend, usaremos uma preferência estática no passo D.

                        // O cardFormData.payer e cardFormData.shipments
                        // conterão os dados de endereço que você precisa!

                        // Substitua este bloco com a chamada para sua API (ver passo D)
                        alert("Dados do cartão e do endereço coletados. Enviando para o Mercado Pago...");
                        return new Promise((resolve, reject) => {
                             // Simule a chamada para sua API (que deve criar uma preferência)
                             // Por enquanto, vamos apenas logar os dados:
                             console.log("Dados coletados:", cardFormData);
                             // Você teria que enviar cardFormData para um servidor que usa seu ACCESS_TOKEN
                             
                             resolve(); // Resolve para continuar o processo.
                        });
                    },
                    onError: (error) => {
                        console.error(error);
                    },
                }
            };
            const settingsWithDynamicData = { ...settings };
            window.paymentBrickController = await bricksBuilder.create("payment", "payment-brick-container", settingsWithDynamicData);
        };

        renderPaymentBrick(bricksBuilder);
    </script>
</body>
</html>
